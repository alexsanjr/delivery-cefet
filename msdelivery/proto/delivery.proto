syntax = "proto3";

package delivery;

service DeliveryService {
  rpc GetDeliveryByOrder (GetDeliveryByOrderRequest) returns (DeliveryResponse);
  rpc GetActiveDeliveries (GetActiveDeliveriesRequest) returns (DeliveriesListResponse);
  rpc GetDeliveryPersonLocation (GetDeliveryPersonLocationRequest) returns (DeliveryPersonLocationResponse);
  rpc UpdateDeliveryStatus (UpdateDeliveryStatusRequest) returns (DeliveryResponse);
}

message GetDeliveryByOrderRequest {
  int32 orderId = 1;
}

message GetActiveDeliveriesRequest {
  repeated string statuses = 1;
}

message GetDeliveryPersonLocationRequest {
  int32 deliveryPersonId = 1;
}

message UpdateDeliveryStatusRequest {
  int32 deliveryId = 1;
  string status = 2;
}

message DeliveryResponse {
  bool success = 1;
  string message = 2;
  Delivery delivery = 3;
}

message DeliveriesListResponse {
  bool success = 1;
  repeated Delivery deliveries = 2;
}

message DeliveryPersonLocationResponse {
  bool success = 1;
  string message = 2;
  DeliveryPersonLocation location = 3;
}

message Delivery {
  int32 id = 1;
  int32 orderId = 2;
  int32 deliveryPersonId = 3;
  string status = 4;
  double customerLatitude = 5;
  double customerLongitude = 6;
  string customerAddress = 7;
  string assignedAt = 8;
  string pickedUpAt = 9;
  string deliveredAt = 10;
  int32 estimatedDeliveryTime = 11;
  DeliveryPerson deliveryPerson = 12;
}

message DeliveryPerson {
  int32 id = 1;
  string name = 2;
  string phone = 3;
  string vehicleType = 4;
  double currentLatitude = 5;
  double currentLongitude = 6;
  string status = 7;
}

message DeliveryPersonLocation {
  int32 id = 1;
  string name = 2;
  double currentLatitude = 3;
  double currentLongitude = 4;
  string lastLocationUpdate = 5;
  string status = 6;
}
