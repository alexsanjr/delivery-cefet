// prisma/schema.prisma
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model RouteCache {
  id                  String   @id @default(uuid())
  origin_lat          Float
  origin_lng          Float
  dest_lat            Float
  dest_lng            Float
  strategy            String
  polyline            String
  distance            Int      // metros
  duration            Int      // segundos
  cost_estimate       Float
  expires_at          DateTime

  @@map("route_cache")
  @@unique([origin_lat, origin_lng, dest_lat, dest_lng, strategy])
  @@index([expires_at])
}

model OptimizedRoute {
  id                  String   @id @default(uuid())
  route_hash          String   @unique
  vehicle_routes      Json     // Array de VehicleRoute
  total_cost          Float
  total_distance      Float
  total_duration      Float
  calculated_at       DateTime @default(now())
  expires_at          DateTime

  @@map("optimized_routes")
  @@index([route_hash])
  @@index([expires_at])
}